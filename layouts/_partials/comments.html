{{- /* Comments area start */ -}}
{{- /* to add comments read => https://gohugo.io/content-management/comments/ */ -}}
<section class="comments">
    <h2>Comments</h2>
    <script>
        const getStoredTheme = () => localStorage.getItem("theme") === "dark" ? "dark" : "light";

        const setGiscusTheme = () => {
            const sendMessage = (message) => {
                const iframe = document.querySelector('iframe.giscus-frame');
                if (iframe) {
                    iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
                }
            }
            sendMessage({ setConfig: { theme: getStoredTheme() } })
        }

        document.addEventListener("DOMContentLoaded", () => {
            const giscusAttributes = {
                "src": "https://giscus.app/client.js",
                "data-repo": "julianferrone/personal-site",
                "data-repo-id": "R_kgDOOkrcEw",
                "data-category": "Announcements",
                "data-category-id": "DIC_kwDOOkrcE84CzNJ8",
                "data-mapping": "og:title",
                "data-strict": "1",
                "data-reactions-enabled": "0",
                "data-emit-metadata": "0",
                "data-input-position": "top",
                "data-theme": getStoredTheme(),
                "data-lang": "en",
                "data-loading": "lazy",
                "crossorigin": "anonymous",
                "async": "",
            };

            // Dynamically create script tag.
            const giscusScript = document.createElement("script");
            Object.entries(giscusAttributes).forEach(
                ([key, value]) => giscusScript.setAttribute(key, value));
            console.log(giscusScript)
            document.querySelector(".comments").appendChild(giscusScript);

            // Update giscus theme when the theme switcher is clicked.
            const themeSwitcher = document.getElementById("theme-switch");
            if (themeSwitcher) {
                themeSwitcher.addEventListener("click", setGiscusTheme);
            }
        });
    </script>
</section>
{{- /* Comments area end */ -}}